<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOMIES - A SET Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .card.selected {
            transform: translateY(-6px);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4);
            border-color: #3b82f6;
        }
        .card.valid {
            animation: pulse 1s infinite;
            border-color: #10b981;
        }
        .card.wrong {
            animation: shake 0.5s;
            border-color: #ef4444;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .found-set {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Accessibility improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .card:focus-visible {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: #6366f1;
            background-color: #f8fafc;
        }
        
        button:focus-visible {
            outline: 3px solid #3b82f6;
            outline-offset: 2px;
        }
        
        .modal:focus-visible {
            outline: none;
        }
        
        input:focus-visible {
            outline: 3px solid #3b82f6;
            outline-offset: 2px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-100 to-pink-100 min-h-screen p-4">
    <header class="bg-white rounded-2xl shadow-2xl p-6 mb-6">
        <h1 class="text-4xl font-bold text-center text-gray-800 mb-2">HOMIES</h1>
        <p class="text-center text-gray-600 text-lg mb-2">Find your homies! Inspired by the game SET</p>
        <p class="text-center text-gray-600 mb-6">Find sets of 3 people where each attribute is all the same OR all different!</p>
    </header>

    <main class="max-w-6xl mx-auto">
        <div class="bg-white rounded-2xl shadow-2xl p-6">
            <div class="flex justify-between items-start mb-6">
                <section class="flex-1" aria-labelledby="game-status-heading">
                    <h2 id="game-status-heading" class="sr-only">Game Status</h2>
                    <div class="text-center text-xl font-semibold text-gray-700 mb-2" id="status" role="status" aria-live="polite">Select 3 cards to form a set</div>
                    <div class="flex justify-center space-x-6 text-sm text-gray-500">
                        <span>Sets Found: <span id="score" class="font-bold">0</span></span>
                        <span>Cards Left: <span id="cardsLeft" class="font-bold">12</span></span>
                    </div>
                </section>
                
                <aside class="w-64 ml-6" aria-labelledby="found-sets-heading">
                    <h2 id="found-sets-heading" class="text-lg font-semibold text-gray-700 mb-3">Found Sets:</h2>
                    <div id="foundSets" class="space-y-2 max-h-60 overflow-y-auto" aria-live="polite">
                        <!-- Found sets will appear here -->
                    </div>
                </aside>
            </div>

            <section aria-labelledby="attributes-heading" class="mb-6">
                <h2 id="attributes-heading" class="text-lg font-semibold text-gray-700 mb-3">Attributes Legend:</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div class="flex items-center space-x-2">
                        <span class="font-semibold">First Emoji:</span>
                        <div class="text-xs">Clothes + Hair Color + Arms</div>
                        <div class="flex space-x-1">
                            <span class="text-lg">üôáüèº‚Äç‚ôÄÔ∏è</span>
                            <span class="text-lg">üôãüèΩ</span>
                            <span class="text-lg">ü§∑üèø‚Äç‚ôÇÔ∏è</span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="font-semibold">Second Emoji:</span>
                        <div class="text-xs">Style</div>
                        <div class="flex space-x-1">
                            <span class="text-lg">üíñ</span>
                            <span class="text-lg">üé∏</span>
                            <span class="text-lg">üß™</span>
                        </div>
                    </div>
                </div>
                <div class="mt-3 text-xs text-gray-600">
                    <div><strong>First Emoji breakdown:</strong></div>
                    <div>üôá = Bowing (No Arms), üôã = Raising Hand (One Arm), ü§∑ = Shrugging (Two Arms)</div>
                    <div>Each can be wearing Purple, Grey, or Blue, with Blond (üë±üèª‚Äç‚ôÄÔ∏è), Brown (üë©üèΩ), or Black (üßëüèø‚Äçü¶±) hair</div>
                </div>
            </section>

            <section aria-label="Game Board" class="mb-6">
                <div id="gameBoard" class="grid grid-cols-3 md:grid-cols-4 gap-4" role="grid" aria-label="Game cards">
                    <!-- Cards will be generated here -->
                </div>
            </section>

            <nav aria-label="Game Controls" class="flex justify-center space-x-3">
                <button id="newGameBtn" class="bg-purple-500 hover:bg-purple-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105">
                    New Game
                </button>
                <button id="hintBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105">
                    Hint
                </button>
                <button id="autoFindBtn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105">
                    Auto Find
                </button>
                <button id="reshuffleBtn" class="bg-orange-500 hover:bg-orange-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105 hidden">
                    Reshuffle Cards
                </button>
            </nav>
        </div>
    </main>

    <!-- Set Naming Modal -->
    <div id="setNamingModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-description">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4 modal" role="document">
            <h2 id="modal-title" class="text-2xl font-bold text-gray-800 mb-4">Great Set Found! üéâ</h2>
            <p id="modal-description" class="text-gray-600 mb-4">You found a valid set! Give these homies a group name:</p>
            
            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <h3 class="font-semibold text-gray-700 mb-3">Your Set:</h3>
                <div id="setPreview" class="flex justify-center space-x-4" aria-live="polite">
                    <!-- Set preview will appear here -->
                </div>
            </div>
            
            <div class="mb-4">
                <label for="groupNameInput" class="block text-sm font-medium text-gray-700 mb-2">Group Name:</label>
                <input type="text" id="groupNameInput" placeholder="Enter group name (e.g., 'The Rock Band')" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" 
                       aria-describedby="group-name-help">
                <p id="group-name-help" class="sr-only">Enter a name for your group of homies</p>
            </div>
            
            <div class="flex space-x-3">
                <button id="confirmNameBtn" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                    Confirm Name
                </button>
                <button id="cancelNameBtn" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Skip to main content link for keyboard users -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-500 text-white px-4 py-2 rounded">
        Skip to main content
    </a>
    <div id="main-content" tabindex="-1"></div>

    <script>
        class HomiesGame {
            constructor() {
                // Generate all 81 unique permutations
                this.fullDeck81 = this.generateFullDeck81();
                this.usedCards = new Set();
                this.selectedCards = [];
                this.score = 0;
                this.gameBoard = [];
                this.setsFound = [];
                this.remainingDeck = [];
                
                this.initializeGame();
                this.bindEvents();
                
                // Announce game start to screen readers
                this.announceToScreenReader("HOMIES game started. Use Tab to navigate cards, or use the Hint and Auto Find buttons.");
            }

            generateFullDeck81() {
                const deck = [];
                const armTypes = ['bowing', 'raising', 'shrugging'];
                const genders = ['female', 'person', 'male'];
                const skins = ['light', 'medium', 'dark'];
                const styles = ['girly', 'punk', 'nerd'];
                
                // Generate all 81 unique combinations
                for (let armType of armTypes) {
                    for (let gender of genders) {
                        for (let skin of skins) {
                            for (let style of styles) {
                                deck.push({
                                    id: `${armType}-${gender}-${skin}-${style}`,
                                    armType: armType,
                                    gender: gender,
                                    skin: skin,
                                    style: style,
                                    emoji: this.createEmoji(armType, gender, skin),
                                    selected: false
                                });
                            }
                        }
                    }
                }
                
                return deck;
            }

            createEmoji(armType, gender, skin) {
                const skinTone = {
                    'light': 'üèº',
                    'medium': 'üèΩ',
                    'dark': 'üèø'
                };
                
                const genderMarker = {
                    'female': '‚Äç‚ôÄÔ∏è',
                    'person': '',
                    'male': '‚Äç‚ôÇÔ∏è'
                };
                
                const baseEmoji = {
                    'bowing': 'üôá',
                    'raising': 'üôã',
                    'shrugging': 'ü§∑'
                };
                
                return baseEmoji[armType] + skinTone[skin] + genderMarker[gender];
            }

            initializeGame() {
                // Shuffle the full deck
                this.shuffleArray(this.fullDeck81);
                
                // Start with 12 cards from the shuffled deck
                this.gameBoard = this.fullDeck81.slice(0, 12);
                this.remainingDeck = this.fullDeck81.slice(12);
                this.usedCards.clear();
                this.setsFound = [];
                this.score = 0;
                
                // Ensure there's at least one set available
                this.ensureAtLeastOneSet();
                
                this.renderBoard();
                this.updateStatus();
                this.updateFoundSets();
            }

            ensureAtLeastOneSet() {
                const availableSets = this.findAvailableSets();
                if (availableSets.length === 0) {
                    // If no sets available, reshuffle
                    this.gameBoard = [...this.gameBoard, ...this.remainingDeck];
                    this.shuffleArray(this.gameBoard);
                    this.gameBoard = this.gameBoard.slice(0, 12);
                    this.remainingDeck = this.gameBoard.slice(12);
                }
            }

            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            renderBoard() {
                const board = document.getElementById('gameBoard');
                board.innerHTML = '';
                
                this.gameBoard.forEach((card, index) => {
                    const cardElement = this.createCardElement(card, index);
                    board.appendChild(cardElement);
                });
                
                this.updateCardsLeft();
            }

            createCardElement(card, index) {
                const cardDiv = document.createElement('article');
                cardDiv.className = `card bg-white rounded-lg p-4 border-2 border-gray-200 text-center ${card.selected ? 'selected' : ''} focus:outline-none`;
                cardDiv.setAttribute('data-id', card.id);
                cardDiv.setAttribute('role', 'gridcell');
                cardDiv.setAttribute('tabindex', '0');
                cardDiv.setAttribute('aria-label', this.getCardAriaLabel(card));
                cardDiv.setAttribute('aria-selected', card.selected);
                
                const styleColor = {
                    'girly': 'text-pink-500',
                    'punk': 'text-red-600',
                    'nerd': 'text-blue-600'
                };
                
                cardDiv.innerHTML = `
                    <div class="flex justify-center items-center space-x-2">
                        <div class="text-6xl">${card.emoji}</div>
                        <div class="text-6xl ${styleColor[card.style]}">${this.getStyleEmoji(card.style)}</div>
                    </div>
                `;
                
                // Add both click and keyboard event listeners
                cardDiv.addEventListener('click', () => this.selectCard(card.id));
                cardDiv.addEventListener('keydown', (e) => this.handleCardKeyDown(e, card.id));
                
                return cardDiv;
            }

            handleCardKeyDown(event, cardId) {
                if (event.key === 'Enter' || event.key === ' ') {
                    event.preventDefault();
                    this.selectCard(cardId);
                }
            }

            getCardAriaLabel(card) {
                const genderLabel = card.gender === 'female' ? 'Female' : 
                                  card.gender === 'male' ? 'Male' : 'Non-binary';
                const skinLabel = card.skin.charAt(0).toUpperCase() + card.skin.slice(1);
                const armLabel = card.armType.charAt(0).toUpperCase() + card.armType.slice(1);
                const styleLabel = card.style.charAt(0).toUpperCase() + card.style.slice(1);
                
                return `${genderLabel}, ${skinLabel} skin, ${armLabel} arms, ${styleLabel} style`;
            }

            getStyleEmoji(style) {
                const styleEmojis = {
                    'girly': 'üíñ',
                    'punk': 'üé∏',
                    'nerd': 'üß™'
                };
                return styleEmojis[style];
            }

            selectCard(cardId) {
                const card = this.gameBoard.find(c => c.id === cardId);
                if (!card || card.selected) return;
                
                if (this.selectedCards.length < 3) {
                    card.selected = true;
                    this.selectedCards.push(card);
                    
                    const cardElement = document.querySelector(`[data-id="${cardId}"]`);
                    cardElement.classList.add('selected');
                    cardElement.setAttribute('aria-selected', 'true');
                    
                    if (this.selectedCards.length === 3) {
                        setTimeout(() => this.checkSet(), 300);
                    }
                }
                
                this.updateStatus();
            }

            checkSet() {
                if (this.selectedCards.length !== 3) return;
                
                const isValidSet = this.isValidSet(this.selectedCards);
                
                if (isValidSet) {
                    this.handleValidSet();
                } else {
                    this.handleInvalidSet();
                }
            }

            isValidSet(cards) {
                // Get all attributes
                const genders = cards.map(card => card.gender);
                const skins = cards.map(card => card.skin);
                const arms = cards.map(card => card.armType);
                const styles = cards.map(card => card.style);
                
                // Check each attribute: must be all same OR all different
                return this.isValidAttribute(genders) && 
                       this.isValidAttribute(skins) && 
                       this.isValidAttribute(arms) && 
                       this.isValidAttribute(styles);
            }

            isValidAttribute(values) {
                const uniqueValues = new Set(values);
                return uniqueValues.size === 1 || uniqueValues.size === 3;
            }

            handleValidSet() {
                // Show set naming modal
                this.showSetNamingModal();
            }

            showSetNamingModal() {
                const modal = document.getElementById('setNamingModal');
                const setPreview = document.getElementById('setPreview');
                
                // Clear previous preview
                setPreview.innerHTML = '';
                
                // Add cards to preview
                this.selectedCards.forEach(card => {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'text-center';
                    cardDiv.setAttribute('aria-hidden', 'true');
                    cardDiv.innerHTML = `
                        <div class="text-4xl mb-1">${card.emoji}</div>
                        <div class="text-2xl ${card.style === 'girly' ? 'text-pink-500' : card.style === 'punk' ? 'text-red-600' : 'text-blue-600'}">${this.getStyleEmoji(card.style)}</div>
                    `;
                    setPreview.appendChild(cardDiv);
                });
                
                // Show modal and trap focus
                modal.classList.remove('hidden');
                document.getElementById('groupNameInput').value = '';
                document.getElementById('groupNameInput').focus();
                
                // Trap focus within modal
                this.trapFocus(modal);
                
                this.announceToScreenReader("Set found! Please name your group of homies.");
            }

            hideSetNamingModal() {
                const modal = document.getElementById('setNamingModal');
                modal.classList.add('hidden');
                // Remove focus trap
                document.removeEventListener('keydown', this.focusTrapHandler);
            }

            trapFocus(modal) {
                this.focusTrapHandler = (e) => {
                    if (e.key === 'Tab') {
                        const focusableElements = modal.querySelectorAll('button, input, [tabindex]:not([tabindex="-1"])');
                        const firstElement = focusableElements;
                        const lastElement = focusableElements[focusableElements.length - 1];
                        
                        if (e.shiftKey && document.activeElement === firstElement) {
                            e.preventDefault();
                            lastElement.focus();
                        } else if (!e.shiftKey && document.activeElement === lastElement) {
                            e.preventDefault();
                            firstElement.focus();
                        }
                    }
                };
                
                document.addEventListener('keydown', this.focusTrapHandler);
            }

            confirmSetName() {
                const groupName = document.getElementById('groupNameInput').value.trim();
                if (!groupName) {
                    this.announceToScreenReader("Please enter a group name.");
                    document.getElementById('groupNameInput').focus();
                    return;
                }
                
                // Add the set with the chosen name
                this.setsFound.push({
                    cards: [...this.selectedCards],
                    name: groupName,
                    timestamp: new Date()
                });
                
                this.announceToScreenReader(`Set named: ${groupName}`);
                
                // Track used cards
                this.selectedCards.forEach(card => {
                    this.usedCards.add(card.id);
                });
                
                this.score++;
                this.updateFoundSets();
                this.hideSetNamingModal();
                
                // Remove the set from the game board and add 3 new cards
                setTimeout(() => {
                    this.gameBoard = this.gameBoard.filter(card => 
                        !this.selectedCards.some(selected => selected.id === card.id)
                    );
                    
                    // Add 3 new cards from remaining deck if available
                    if (this.remainingDeck.length >= 3) {
                        const newCards = this.remainingDeck.splice(0, 3);
                        this.gameBoard.push(...newCards);
                    } else if (this.remainingDeck.length > 0) {
                        this.gameBoard.push(...this.remainingDeck);
                        this.remainingDeck = [];
                    }
                    
                    this.selectedCards = [];
                    this.renderBoard();
                    this.updateStatus();
                }, 500);
                
                this.updateStatus();
            }

            handleInvalidSet() {
                this.selectedCards.forEach(card => {
                    const cardElement = document.querySelector(`[data-id="${card.id}"]`);
                    cardElement.classList.add('wrong');
                });
                
                this.announceToScreenReader("Not a valid set. Please try again.");
                
                setTimeout(() => {
                    this.selectedCards.forEach(card => {
                        card.selected = false;
                        const cardElement = document.querySelector(`[data-id="${card.id}"]`);
                        cardElement.classList.remove('selected', 'wrong');
                        cardElement.setAttribute('aria-selected', 'false');
                    });
                    this.selectedCards = [];
                    this.updateStatus();
                }, 500);
                
                document.getElementById('status').textContent = 'Not a valid set. Try again!';
                document.getElementById('status').style.color = '#ef4444';
            }

            updateStatus() {
                const status = document.getElementById('status');
                if (this.selectedCards.length === 0) {
                    status.textContent = 'Select 3 cards to form a set';
                    status.style.color = '#374151';
                } else if (this.selectedCards.length < 3) {
                    status.textContent = `Selected: ${this.selectedCards.length}/3 cards`;
                    status.style.color = '#374151';
                }
                
                document.getElementById('score').textContent = this.score;
            }

            updateCardsLeft() {
                document.getElementById('cardsLeft').textContent = this.gameBoard.length;
            }

            updateFoundSets() {
                const foundSetsContainer = document.getElementById('foundSets');
                foundSetsContainer.innerHTML = '';
                
                this.setsFound.forEach((foundSet, index) => {
                    const setDiv = document.createElement('div');
                    setDiv.className = 'found-set bg-purple-50 rounded-lg p-3 border border-purple-200';
                    setDiv.setAttribute('role', 'listitem');
                    
                    const cardsHtml = foundSet.cards.map(card => `
                        <div class="inline-block mx-1" aria-hidden="true">
                            <div class="text-2xl">${card.emoji}</div>
                            <div class="text-lg ${card.style === 'girly' ? 'text-pink-500' : card.style === 'punk' ? 'text-red-600' : 'text-blue-600'}">${this.getStyleEmoji(card.style)}</div>
                        </div>
                    `).join('');
                    
                    setDiv.innerHTML = `
                        <div class="text-sm font-semibold text-purple-800 mb-1">${foundSet.name}</div>
                        <div class="flex justify-center">${cardsHtml}</div>
                    `;
                    
                    foundSetsContainer.appendChild(setDiv);
                });
            }

            giveHint() {
                const availableSets = this.findAvailableSets();
                if (availableSets.length > 0) {
                    const hintSet = availableSets;
                    hintSet.forEach(card => {
                        const cardElement = document.querySelector(`[data-id="${card.id}"]`);
                        cardElement.style.border = '3px solid #fbbf24';
                        setTimeout(() => {
                            cardElement.style.border = '2px solid #d1d5db';
                        }, 2000);
                    });
                    document.getElementById('status').textContent = 'Hint: Look for the highlighted cards!';
                    document.getElementById('status').style.color = '#f59e0b';
                    this.announceToScreenReader("Hint: Look for highlighted cards that form a set.");
                } else {
                    this.showReshuffleBtn();
                    document.getElementById('status').textContent = 'No sets available!';
                    document.getElementById('status').style.color = '#ef4444';
                    this.announceToScreenReader("No sets available. Use Reshuffle button to get new cards.");
                }
            }

            autoFindSet() {
                const availableSets = this.findAvailableSets();
                if (availableSets.length > 0) {
                    const foundSet = availableSets;
                    foundSet.forEach(card => {
                        this.selectCard(card.id);
                    });
                    document.getElementById('status').textContent = 'Auto-found a valid set!';
                    document.getElementById('status').style.color = '#10b981';
                    this.announceToScreenReader("Auto-found a valid set! Please name your group.");
                } else {
                    this.showReshuffleBtn();
                    document.getElementById('status').textContent = 'No sets available!';
                    document.getElementById('status').style.color = '#ef4444';
                    this.announceToScreenReader("No sets available. Use Reshuffle button to get new cards.");
                }
            }

            showReshuffleBtn() {
                document.getElementById('reshuffleBtn').classList.remove('hidden');
            }

            hideReshuffleBtn() {
                document.getElementById('reshuffleBtn').classList.add('hidden');
            }

            reshuffleCards() {
                document.getElementById('status').textContent = 'Reshuffling cards...';
                document.getElementById('status').style.color = '#f59e0b';
                
                // Combine current game board and remaining deck
                const newPool = [...this.gameBoard, ...this.remainingDeck];
                
                // Remove any cards that have been used in sets
                const availablePool = newPool.filter(card => 
                    !this.usedCards.has(card.id)
                );
                
                // Shuffle the available pool
                this.shuffleArray(availablePool);
                
                // Deal 12 new cards
                this.gameBoard = availablePool.slice(0, 12);
                this.remainingDeck = availablePool.slice(12);
                
                // Clear any selections
                this.selectedCards = [];
                
                setTimeout(() => {
                    this.renderBoard();
                    this.updateStatus();
                    document.getElementById('status').textContent = 'New cards dealt! Find sets of 3 cards.';
                    document.getElementById('status').style.color = '#374151';
                    this.hideReshuffleBtn();
                    this.announceToScreenReader("Cards reshuffled. New game board loaded.");
                }, 1000);
            }

            newGame() {
                this.selectedCards = [];
                this.score = 0;
                this.setsFound = [];
                this.initializeGame();
                this.updateFoundSets();
                document.getElementById('status').textContent = 'New game started! Find sets of 3 cards.';
                document.getElementById('status').style.color = '#374151';
                this.hideReshuffleBtn();
                this.announceToScreenReader("New game started! Fresh deck of cards.");
            }

            findAvailableSets() {
                const sets = [];
                
                for (let i = 0; i < this.gameBoard.length; i++) {
                    for (let j = i + 1; j < this.gameBoard.length; j++) {
                        for (let k = j + 1; k < this.gameBoard.length; k++) {
                            const potentialSet = [this.gameBoard[i], this.gameBoard[j], this.gameBoard[k]];
                            if (this.isValidSet(potentialSet)) {
                                sets.push(potentialSet);
                            }
                        }
                    }
                }
                
                return sets;
            }

            announceToScreenReader(message) {
                const announcement = document.createElement('div');
                announcement.setAttribute('role', 'status');
                announcement.setAttribute('aria-live', 'polite');
                announcement.className = 'sr-only';
                announcement.textContent = message;
                document.body.appendChild(announcement);
                setTimeout(() => {
                    document.body.removeChild(announcement);
                }, 1000);
            }

            bindEvents() {
                document.getElementById('newGameBtn').addEventListener('click', () => this.newGame());
                document.getElementById('hintBtn').addEventListener('click', () => this.giveHint());
                document.getElementById('autoFindBtn').addEventListener('click', () => this.autoFindSet());
                document.getElementById('reshuffleBtn').addEventListener('click', () => this.reshuffleCards());
                
                document.getElementById('confirmNameBtn').addEventListener('click', () => this.confirmSetName());
                document.getElementById('cancelNameBtn').addEventListener('click', () => this.hideSetNamingModal());
                
                // Allow Enter key to confirm name
                document.getElementById('groupNameInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.confirmSetName();
                    }
                });

                // Close modal on Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.hideSetNamingModal();
                    }
                });

                // Close modal on outside click
                document.getElementById('setNamingModal').addEventListener('click', (e) => {
                    if (e.target.id === 'setNamingModal') {
                        this.hideSetNamingModal();
                    }
                });
            }
        }

        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new HomiesGame();
        });
    </script>
</body>
</html>
